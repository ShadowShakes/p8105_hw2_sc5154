p8105_hw2_sc5154
================
Shaohan Chen
2022-10-02

``` r
library(tidyverse)
library(dplyr)
library(janitor)
```

## Problem 1

The row data for NYC transit subway is:

``` r
subway_raw_data = read_csv("Data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv")
```

First we read and clean the data from the local file. And also retain
the columns mentioned in the problem.

``` r
subway_data = 
  read_csv("Data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names(dat = .) %>%
  select(.data = ., line:entry, vending, ada)
```

Next I conduct some further cleaning.

Remove the rows and columns that are all `NA`s.

``` r
subway_data %>%
  remove_empty(., whic = c("rows")) %>%
  remove_empty(., whic = c("cols")) 
## # A tibble: 1,868 × 19
##    line     station_…¹ stati…² stati…³ route1 route2 route3 route4 route5 route6
##    <chr>    <chr>        <dbl>   <dbl> <chr>  <chr>  <chr>  <chr>  <chr>  <chr> 
##  1 4 Avenue 25th St       40.7   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>  
##  2 4 Avenue 25th St       40.7   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>  
##  3 4 Avenue 36th St       40.7   -74.0 N      R      <NA>   <NA>   <NA>   <NA>  
##  4 4 Avenue 36th St       40.7   -74.0 N      R      <NA>   <NA>   <NA>   <NA>  
##  5 4 Avenue 36th St       40.7   -74.0 N      R      <NA>   <NA>   <NA>   <NA>  
##  6 4 Avenue 45th St       40.6   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>  
##  7 4 Avenue 45th St       40.6   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>  
##  8 4 Avenue 45th St       40.6   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>  
##  9 4 Avenue 45th St       40.6   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>  
## 10 4 Avenue 53rd St       40.6   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>  
## # … with 1,858 more rows, 9 more variables: route7 <chr>, route8 <dbl>,
## #   route9 <dbl>, route10 <dbl>, route11 <dbl>, entrance_type <chr>,
## #   entry <chr>, vending <chr>, ada <lgl>, and abbreviated variable names
## #   ¹​station_name, ²​station_latitude, ³​station_longitude
```

Check the data types of the columns.

``` r
summary(subway_data)
##      line           station_name       station_latitude station_longitude
##  Length:1868        Length:1868        Min.   :40.58    Min.   :-74.03   
##  Class :character   Class :character   1st Qu.:40.69    1st Qu.:-73.99   
##  Mode  :character   Mode  :character   Median :40.73    Median :-73.96   
##                                        Mean   :40.73    Mean   :-73.94   
##                                        3rd Qu.:40.77    3rd Qu.:-73.91   
##                                        Max.   :40.90    Max.   :-73.76   
##                                                                          
##     route1             route2             route3             route4         
##  Length:1868        Length:1868        Length:1868        Length:1868       
##  Class :character   Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character   Mode  :character  
##                                                                             
##                                                                             
##                                                                             
##                                                                             
##     route5             route6             route7              route8     
##  Length:1868        Length:1868        Length:1868        Min.   :1.000  
##  Class :character   Class :character   Class :character   1st Qu.:1.000  
##  Mode  :character   Mode  :character   Mode  :character   Median :4.000  
##                                                           Mean   :2.979  
##                                                           3rd Qu.:5.000  
##                                                           Max.   :5.000  
##                                                           NA's   :1820   
##      route9         route10        route11     entrance_type     
##  Min.   :2.000   Min.   :3      Min.   :7      Length:1868       
##  1st Qu.:2.000   1st Qu.:3      1st Qu.:7      Class :character  
##  Median :2.000   Median :3      Median :7      Mode  :character  
##  Mean   :2.536   Mean   :3      Mean   :7                        
##  3rd Qu.:2.000   3rd Qu.:3      3rd Qu.:7                        
##  Max.   :5.000   Max.   :3      Max.   :7                        
##  NA's   :1840    NA's   :1845   NA's   :1845                     
##     entry             vending             ada         
##  Length:1868        Length:1868        Mode :logical  
##  Class :character   Class :character   FALSE:1400     
##  Mode  :character   Mode  :character   TRUE :468      
##                                                       
##                                                       
##                                                       
## 
```

And I figure out that the route 8-11 have different data types from
route 1-7. After checking specific data, it is because the route 8-11 is
named by number. In order to avoid mistakes in further process like
`pivot_longer`, I transform the data type of route 8-11 into characters.

``` r
subway_data$route8 = as.character(subway_data$route8)
subway_data$route9 = as.character(subway_data$route9)
subway_data$route10 = as.character(subway_data$route10)
subway_data$route11 = as.character(subway_data$route11)
```

Convert the entry variable from character to a logical variable

``` r
subway_data$entry = recode(subway_data$entry, 'YES' = TRUE, 'NO' = FALSE)
```

The raw dataset contains 32 columns before my cleaning and tailor, which
include various detailed descriptive elements of the NYC transit subway
system, including the line index, station name, station size, the routes
operated in the station, the entrance information, ada, station location
and entrance location, etc.

So far my data cleaning steps include: 1. `janitor::clean_names` to
clean the column names.

2.  Remove the row and columns that are all `NA`s.

3.  Transform the types of route8-11 into characters for consisitency.

4.  Convert the `entry` column from ‘YES’ or ‘NO’ to the logical
    variable.

The dimension of the resulting dataset is:

``` r
subway_data_rows = nrow(subway_data)
subway_data_cols = ncol(subway_data)
```

Totally 1868 rows and 19 columns.

These data are not so tidy. The columns `route1` to `route11` contain
too much `NA` values, which makes the dataset too wide. Route names and
route numbers should be variables.

``` r
subway_data %>% 
  select(station_name, line) %>% 
  distinct %>%
  nrow
## [1] 465
```

There are 465 distinct stations.

``` r
subway_data %>% 
  filter(ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct %>%
  nrow
## [1] 84
```

There are 84 stations that are ADA complaint.

``` r
subway_data %>%
  filter(vending == "NO") %>% 
  pull(entry) %>% 
  mean
## [1] 0.3770492
```

The proportion of station entrances/exits without vending allow entrance
is 0.3770.

Next I reformat the data to make route number and route name be distinct
variables.

``` r
subway_tidy_data = 
  subway_data %>% 
    pivot_longer(
      route1:route11,
      names_to = "route_index",
      values_to = "route_name") 
head(subway_tidy_data,5)
## # A tibble: 5 × 10
##   line     station…¹ stati…² stati…³ entra…⁴ entry vending ada   route…⁵ route…⁶
##   <chr>    <chr>       <dbl>   <dbl> <chr>   <lgl> <chr>   <lgl> <chr>   <chr>  
## 1 4 Avenue 25th St      40.7   -74.0 Stair   TRUE  YES     FALSE route1  R      
## 2 4 Avenue 25th St      40.7   -74.0 Stair   TRUE  YES     FALSE route2  <NA>   
## 3 4 Avenue 25th St      40.7   -74.0 Stair   TRUE  YES     FALSE route3  <NA>   
## 4 4 Avenue 25th St      40.7   -74.0 Stair   TRUE  YES     FALSE route4  <NA>   
## 5 4 Avenue 25th St      40.7   -74.0 Stair   TRUE  YES     FALSE route5  <NA>   
## # … with abbreviated variable names ¹​station_name, ²​station_latitude,
## #   ³​station_longitude, ⁴​entrance_type, ⁵​route_index, ⁶​route_name
```

Count the number of distinct stations that serve the A train.

``` r
subway_tidy_data %>%
  filter(route_name == "A") %>% 
  select(station_name, line) %>% 
  distinct %>%
  nrow
## [1] 60
```

Therefore, there are 60 distinct stations serve the A train.

``` r
subway_tidy_data %>%
  filter(route_name == "A", ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct %>%
  nrow
## [1] 17
```

Therefore, there are 17 distinct stations serve the A train and are ADA
complaint.
